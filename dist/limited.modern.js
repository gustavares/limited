class t{constructor({x:t,y:e}){this.x=t,this.y=e}plus(e){return new t({x:this.x+e.x,y:this.y+e.y})}}class e{constructor({name:e,type:s,position:i,width:n,height:o,color:r,speed:a,sprite:h}){this.name=e,this.type=s,this.position=i||new t({x:0,y:0}),this.width=n,this.height=o,this.color=r,this.speed=a||new t({x:0,y:0}),this.sprite=h}getCenter(){return new t({x:this.position.x+this.width/2,y:this.position.y+this.height/2})}update(e){this.position=new t({x:this.position.x+this.speed.x*e,y:this.position.y+this.speed.y*e})}}const s={UP:38,DOWN:40,RIGHT:39,LEFT:37,W:87,A:65,S:83,D:68,SPACE:32};class i{constructor(){this.keyState={},this.keyDownHandler=t=>{t.preventDefault(),this.keyState[t.keyCode||t.which]=!0},this.keyUpHandler=t=>{t.preventDefault(),this.keyState[t.keyCode||t.which]=!1},window.addEventListener("keydown",this.keyDownHandler),window.addEventListener("keyup",this.keyUpHandler)}}class n{constructor({gameObjects:t,textObjects:e,state:s}){this.gameObjects=t,this.textObjects=e,this.state=s,this.keyboard=new i}setGameObjects(t){this.gameObjects=t}getGameObject(t){return this.gameObjects.find(e=>e.name===t)}getGameObjectsByType(t){return this.gameObjects.map(e=>e.type===t)}getGameObjects(){return this.gameObjects}getTextObject(t){return this.textObjects.find(e=>e.label===t)}deleteTextObject(t){const e=this.textObjects.findIndex(e=>e.label===t);-1!==e&&this.textObjects.splice(e,1)}update(t){this.gameObjects.forEach(e=>e.update(t))}}class o{constructor({content:t,label:e,position:s,font:i="18px verdana"}){Object.assign(this,{content:t,label:e,position:s,font:i})}write(t){t.font=this.font,t.fillText(this.content,this.position.x,this.position.y)}update(t){return this.content=t,this}}class r{constructor({canvasId:t,width:e,height:s}){this.canvas=document.getElementById(t),this.canvas.width=e,this.canvas.height=s,this.context=this.canvas.getContext("2d")}clear(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}renderObjects(t,e,s){for(const i of t){const{name:t,width:n,height:o,color:r,sprite:a,position:h}=i;let{x:c,y:d}=h;if(void 0===t)throw Error("name not found");if(void 0===c)throw Error("x not found");if(void 0===d)throw Error("y not found");if(void 0===n)throw Error("width not found");if(void 0===o)throw Error("height not found");if(void 0===r)throw Error("color not found");if(e.length){const i=e.find(e=>e.name===t);i&&(c=c*s+i.position.x*(1-s),d=d*s+i.position.y*(1-s))}if(void 0!==a){const t=a.getCurrentSpritePosition();this.context.drawImage(a,t.x*n,t.y*o,a.width,a.height,c,d,n,o)}else this.context.fillStyle=r,this.context.fillRect(c,d,n,o)}}write(t){for(const e of t)e.write(this.context)}}const a={currentFps:1,framesThisSecond:0,lastFpsUpdate:0,decayRatio:.25,MS_PER_UPDATE:Number((1e3/60).toFixed(1))};let h=0;function c({firstState:t,screen:e,update:s}){const i=a.MS_PER_UPDATE;let n,r=0,c=window.performance.now(),d=t;const p=t=>{const u=t-c;for(c=t,r+=u,t>a.lastFpsUpdate+1e3&&(a.currentFps=a.decayRatio*a.framesThisSecond+(1-a.decayRatio)*a.currentFps,a.lastFpsUpdate=t,a.framesThisSecond=0),a.framesThisSecond++;r>=i;)n=d,s({state:d,dt:i}),d.update(i),r-=i;h++,function(t,{currentState:e,previousState:s,interpolation:i,texts:n}){t.clear(),t.write(n);const o=s?s.getGameObjects():[];t.renderObjects(e.getGameObjects(),o,i)}(e,{currentState:d,previousState:n,texts:[new o({content:`FPS: ${Math.round(a.currentFps)}`,position:{x:1400,y:30},label:"FPS"}),...d.textObjects],interpolation:r/a.MS_PER_UPDATE}),window.requestAnimationFrame(p)};p(window.performance.now())}class d extends Image{constructor({spriteSheetWidth:t,spriteSheetHeight:e,numberOfSprites:s,maxSpritesPerRow:i,numberOfRows:n,currentAnimationStateName:o,animationStates:r,src:a}){super(t/i,e/n),this.maxSpritesPerRow=i,this.numberOfSprites=s,this.numberOfRows=n,this.spriteSheetWidth=t,this.spriteSheetHeight=e,this.currentAnimationStateName=o,this.animationStates=r,this.src=a}getCurrentSpritePosition(){const t=this.animationStates.findIndex(t=>t.name===this.currentAnimationStateName),e=this.animationStates[t];return{x:Math.floor(h/6)%e.numberOfFrames,y:t}}}class p{constructor({name:t,numberOfFrames:e}){this.name=t,this.numberOfFrames=e}}export{p as AnimationState,e as GameObject,r as GameScreen,i as Keyboard,d as SpriteSheet,n as State,o as Text,t as Vector,h as framesRendered,s as keyCodes,c as start};
//# sourceMappingURL=limited.modern.js.map
