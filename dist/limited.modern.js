function t(){return(t=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t}).apply(this,arguments)}class e{constructor({x:t,y:e}){this.x=t,this.y=e}plus(t){return new e({x:this.x+t.x,y:this.y+t.y})}}class s{constructor({name:t,type:s,position:n,width:o,height:i,color:r,speed:c}){this.name=t,this.type=s,this.position=n||new e({x:0,y:0}),this.width=o,this.height=i,this.color=r,this.speed=c||new e({x:0,y:0})}update(n){return new s(t({},this,{position:new e({x:this.position.x+this.speed.x*n,y:this.position.y+this.speed.y*n})}))}}const n={UP:38,DOWN:40,RIGHT:39,LEFT:37,W:87,A:65,S:83,D:68,SPACE:32};class o{constructor(){this.keyState={},this.keyDownHandler=t=>{t.preventDefault(),this.keyState[t.keyCode||t.which]=!0},this.keyUpHandler=t=>{t.preventDefault(),this.keyState[t.keyCode||t.which]=!1},window.addEventListener("keydown",this.keyDownHandler),window.addEventListener("keyup",this.keyUpHandler)}}class i{constructor({gameObjects:t,textObjects:e,state:s}){this.gameObjects=t,this.textObjects=e,this.state=s,this.keyboard=new o}setGameObjects(t){this.gameObjects=t}getGameObject(t){return this.gameObjects.find(e=>e.name===t)}getGameObjectsByType(t){return this.gameObjects.map(e=>e.type===t)}getGameObjects(){return this.gameObjects}getTextObject(t){return this.textObjects.find(e=>e.label===t)}deleteTextObject(t){const e=this.textObjects.findIndex(e=>e.label===t);-1!==e&&this.textObjects.splice(e,1)}update(e){const s=[];for(const t of this.gameObjects)s.push(t.update(e));return new i(t({},this,{gameObjects:s}))}}class r{constructor({content:t,label:e,position:s,font:n="18px verdana"}){Object.assign(this,{content:t,label:e,position:s,font:n})}write(t){t.font=this.font,t.fillText(this.content,this.position.x,this.position.y)}update(t){return this.content=t,this}}class c{constructor({canvasId:t,width:e,height:s}){this.canvas=document.getElementById(t),this.canvas.width=e,this.canvas.height=s,this.context=this.canvas.getContext("2d")}clear(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}renderObjects(t,e,s){for(const n of t){const{name:t,width:o,height:i,color:r}=n;let{x:c,y:a}=n.position;if(void 0===t)throw Error("name not found");if(void 0===c)throw Error("x not found");if(void 0===a)throw Error("y not found");if(void 0===o)throw Error("width not found");if(void 0===i)throw Error("height not found");if(void 0===r)throw Error("color not found");if(e.length){const n=e.find(e=>e.name===t);n&&(c=c*s+n.position.x*(1-s),a=a*s+n.position.y*(1-s))}this.context.fillStyle=r,this.context.fillRect(c,a,o,i)}}write(t){for(const e of t)e.write(this.context)}}const a={currentFps:1,framesThisSecond:0,lastFpsUpdate:0,decayRatio:.25,MS_PER_UPDATE:Number((1e3/60).toFixed(1))};function h({firstState:t,screen:e,update:s}){const n=[t],o=a.MS_PER_UPDATE;let i=0,c=window.performance.now();const h=t=>{const d=t-c;for(c=t,i+=d,t>a.lastFpsUpdate+1e3&&(a.currentFps=a.decayRatio*a.framesThisSecond+(1-a.decayRatio)*a.currentFps,a.lastFpsUpdate=t,a.framesThisSecond=0),a.framesThisSecond++;i>=o;){const t=s({state:n[n.length-1],dt:o});n.push(t),i-=o}const p=n[n.length-1];!function(t,{currentState:e,previousState:s,interpolation:n,texts:o}){t.clear(),t.write(o);const i=s?s.getGameObjects():[];t.renderObjects(e.getGameObjects(),i,n)}(e,{currentState:p,previousState:n[n.length-2],texts:[new r({content:`FPS: ${Math.round(a.currentFps)}`,position:{x:1400,y:30},label:"FPS"}),...p.textObjects],interpolation:i/a.MS_PER_UPDATE}),window.requestAnimationFrame(h)};h(window.performance.now())}export{s as GameObject,c as GameScreen,o as Keyboard,i as State,r as Text,e as Vector,n as keyCodes,h as start};
//# sourceMappingURL=limited.modern.js.map
